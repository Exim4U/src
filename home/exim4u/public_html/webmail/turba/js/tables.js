if(window.addEventListener){window.addEventListener("load",table_init,false)}else{if(window.attachEvent){window.attachEvent("onload",table_init)}else{if(window.onload!=null){var old_onload=window.onload;window.onload=function(A){old_onload(A);table_init()}}else{window.onload=table_init}}}var SORT_COLUMN_INDEX;function table_init(){if(!document.getElementsByTagName){return }tables=document.getElementsByTagName("table");for(var A=0;A<tables.length;++A){if(hasClass(tables[A],"striped")){table_stripe(tables[A])}if(hasClass(tables[A],"sortable")&&tables[A].id){table_makeSortable(tables[A])}}}function table_stripe(D){var E=false;var B=D.childNodes;for(var F=0;F<B.length;++F){if(B[F].tagName!="TBODY"){continue}var A=B[F].childNodes;for(var C=0;C<A.length;++C){if(A[C].tagName=="TR"){removeClass(A[C],"rowEven");removeClass(A[C],"rowOdd");addClass(A[C],E?"rowEven":"rowOdd");E=!E}}}}function table_makeSortable(C){if(C.rows&&C.rows.length>0){var D=C.rows[0]}if(!D){return }for(var B=0;B<D.cells.length;++B){var A=D.cells[B];if(hasClass(A,"nosort")){continue}A.columnIndex=B;A.style.cursor="pointer";A.onclick=function(E){var E=E||window.event;if(E.target){if(E.target.nodeType==3){E.target=E.target.parentNode}}else{if(E.srcElement){E.target=E.srcElement}}el=hasParent(E.target,"A","TH");if(el&&!hasClass(el,"sortlink")){return true}table_resortTable(getParent(E.target,"TH"));return false}}}function table_getSortValue(D){if(typeof D=="string"){return D.replace(/^\s+/,"").replace(/\s+$/,"")}if(typeof D=="undefined"){return D}if((D.hasAttribute&&D.hasAttribute("sortval"))||typeof D.sortval!="undefined"){return D.getAttribute("sortval")}if(D.innerText){return D.innerText.replace(/^\s+/,"").replace(/\s+$/,"")}var E="";var C=D.childNodes;var A=C.length;for(var B=0;B<A;++B){switch(C[B].nodeType){case 1:E+=table_getSortValue(C[B]);break;case 3:E+=C[B].nodeValue;break}}return E.replace(/^\s+/,"").replace(/\s+$/,"")}function table_resortTable(C){table=getParent(C,"TABLE");sortColumn=C.columnIndex;sortDown=0;theads=table.tHead.getElementsByTagName("th");for(var B=0;B<theads.length;++B){if(C==theads[B]){if(hasClass(theads[B],"sortup")){removeClass(theads[B],"sortup");addClass(theads[B],"sortdown")}else{if(hasClass(theads[B],"sortdown")){removeClass(theads[B],"sortdown");addClass(theads[B],"sortup");sortDown=1}else{addClass(theads[B],"sortdown")}}}else{removeClass(theads[B],"sortup");removeClass(theads[B],"sortdown")}}if(table.rows.length<=1){return }var D=table_getSortValue(table.rows[1].cells[sortColumn]);sortfn=table_sort_caseinsensitive;if(D.match(/^\d\d[\/\.-]\d\d[\/\.-]\d\d(\d\d)?$/)){sortfn=table_sort_date}else{if(D.match(/^[??$?????]/)){sortfn=table_sort_currency}else{if(D.match(/^[\d\.]+$/)){sortfn=table_sort_numeric}}}SORT_COLUMN_INDEX=sortColumn;for(var B=0;B<table.tBodies.length;++B){trs=table.tBodies[B].getElementsByTagName("tr");newRows=[];for(var A=0;A<trs.length;++A){newRows[A]=trs[A]}newRows.sort(sortfn);if(sortDown){newRows.reverse()}for(var A=0;A<newRows.length;++A){if(!hasClass(newRows[A],"sortbottom")){table.tBodies[B].appendChild(newRows[A])}}for(var A=0;A<newRows.length;++A){if(hasClass(newRows[A],"sortbottom")){table.tBodies[B].appendChild(newRows[A])}}}if(hasClass(table,"striped")){table_stripe(table)}if(typeof (table_sortCallback)=="function"){table_sortCallback(table.id,C.id,sortDown)}}function getParent(B,A){if(B==null){return null}else{if(A==null){return B.parentNode}else{if(B.nodeType==1&&B.tagName.toLowerCase()==A.toLowerCase()){return B}else{return getParent(B.parentNode,A)}}}}function table_sort_date(B,A){aa=table_getSortValue(B.cells[SORT_COLUMN_INDEX]);bb=table_getSortValue(A.cells[SORT_COLUMN_INDEX]);if(aa.length==10){dt1=aa.substr(6,4)+aa.substr(3,2)+aa.substr(0,2)}else{yr=aa.substr(6,2);if(parseInt(yr)<50){yr="20"+yr}else{yr="19"+yr}dt1=yr+aa.substr(3,2)+aa.substr(0,2)}if(bb.length==10){dt2=bb.substr(6,4)+bb.substr(3,2)+bb.substr(0,2)}else{yr=bb.substr(6,2);if(parseInt(yr)<50){yr="20"+yr}else{yr="19"+yr}dt2=yr+bb.substr(3,2)+bb.substr(0,2)}if(dt1==dt2){return 0}else{if(dt1<dt2){return -1}}return 1}function table_sort_currency(B,A){aa=table_getSortValue(B.cells[SORT_COLUMN_INDEX]).replace(/[^0-9.]/g,"");bb=table_getSortValue(A.cells[SORT_COLUMN_INDEX]).replace(/[^0-9.]/g,"");return parseFloat(aa)-parseFloat(bb)}function table_sort_numeric(B,A){aa=parseFloat(table_getSortValue(B.cells[SORT_COLUMN_INDEX]));if(isNaN(aa)){aa=0}bb=parseFloat(table_getSortValue(A.cells[SORT_COLUMN_INDEX]));if(isNaN(bb)){bb=0}return aa-bb}function table_sort_caseinsensitive(B,A){aa=table_getSortValue(B.cells[SORT_COLUMN_INDEX]).toLowerCase();bb=table_getSortValue(A.cells[SORT_COLUMN_INDEX]).toLowerCase();if(aa==bb){return 0}else{if(aa<bb){return -1}}return 1}function table_sort_default(B,A){aa=table_getSortValue(B.cells[SORT_COLUMN_INDEX]);bb=table_getSortValue(A.cells[SORT_COLUMN_INDEX]);if(aa==bb){return 0}else{if(aa<bb){return -1}}return 1}function hasParent(C,A,B){if(C.tagName==A){return C}else{if(B!=null&&C.tagName==B){return false}else{return hasParent(getParent(C),A,B)}}}function addClass(B,A){B.className+=B.className?" "+A:A}function removeClass(B,A){B.className=B.className.replace(new RegExp(" ?"+A+" ?"),"")}function hasClass(B,A){return(B.className.indexOf(A)!=-1)};